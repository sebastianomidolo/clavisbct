<%
  mypath=sbct_titles_path(:selection_mode=>'S')
  link_to('<b>Selezione titoli</b>'.html_safe, mypath, class:'btn btn-warning') if can? :create, SbctItem
%>

<!--

  ["Titoli duplicati","params[:controller]=='sbct_titles' and params[:action] == 'ean_duplicati'", "can? :manage, SbctTitle", "ean_duplicati_sbct_titles_path"],
  ["Fatture", "params[:controller]=='sbct_invoices'", "can? :index, SbctInvoice", "sbct_invoices_path"],

-->

<%
  h = [
  ["Eventi","params[:controller]=='sbct_events'", "can? :index, SbctEvent and user_session[:events_mode]=='on'","sbct_events_path"],
  ["Tipologie eventi","params[:controller]=='sbct_event_types'", "can? :manage, SbctEventType and user_session[:events_mode]=='on'","sbct_event_types_path"],
  ["Liste","params[:controller]=='sbct_lists'", "can? :index, SbctList", "sbct_lists_path(locked:false)"],
  ["Copie","params[:controller]=='sbct_items'", "can? :index, SbctItem", "sbct_items_path"],
  ["Budgets","params[:controller]=='sbct_budgets'", "can? :index, SbctBudget", "sbct_budgets_path"],
  ["Fornitori","params[:controller]=='sbct_suppliers'", "can? :index, SbctSupplier", "sbct_suppliers_path"],
  ["Ordini","params[:controller]=='sbct_orders'", "can? :index, SbctOrder", "sbct_orders_path"],
  ["PiÃ¹ richiesti", "params[:controller]=='sbct_titles' and params[:action]=='piurichiesti'", "can? :index, SbctTitle", "piurichiesti_sbct_titles_path"],
  ["Inserimento titolo", "params[:controller]=='sbct_titles' and params[:action]=='new'", "can? :create, SbctTitle", "new_sbct_title_path"],
  ["PacUsers", "params[:controller]=='sbct_titles' and params[:action]=='view_users'", "current_user.role?('AcquisitionManager')", "view_users_sbct_titles_path"],
  ["CaricaReport", "params[:controller]=='sbct_titles' and params[:action]=='upload'", "current_user.role?('AcquisitionManager')", "upload_sbct_titles_path"],
  ["Crea scorciatoia", "params[:controller]=='sbct_presets' and params[:action]=='create'", "current_user.role?('AcquisitionManager')", "new_sbct_preset_path(path:request.original_url)"],
  ["Scorciatoie", "params[:controller]=='sbct_presets'", "current_user.role?('AcquisitionLibrarian')", "sbct_presets_path"],
  ]

  (
    nsf = params[:nosearchform].blank? ? true : nil
    h <<  ["Tinybox (<span id='tinybox_cnt'>#{user_session[:tinybox].size}</span>)","params[:controller]=='sbct_titles' and params[:action]=='tinybox'", "can? :index, SbctTitle", "sbct_titles_path(nosearchform:nsf,tinybox:true, check_boxes:'S')"]
  )

%>
<%=
  res = []
  h.each do |e|
   txt,cond,auth,path = e
   next if !(eval auth)
   if (eval cond)
    res << content_tag(:span, "<b>#{txt}</b>".html_safe, class:'label label-primary', style:'color:#aaeedd;background:#1a1a1a')
  else
    res << link_to("<b>#{txt}</b>".html_safe, (eval path), class:'btn btn-warning')
   end
  end
  content_tag(:div, res.join(' ').html_safe)
%>

<%= javascript_tag type: 'application/javascript' do -%>
    if (jQuery('#tinybox_cnt').text() == '0') {
	jQuery("a:contains('Tinybox')").hide();
    }
<% end -%>
	   
<% content_tag(:h6, "PAC - Sistema acquisti Centro Rete, in funzione dal 9 settembre 2022") %>

